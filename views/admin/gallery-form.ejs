<%- include('../partials/header') %>

<main class="admin-container">
  <div class="admin-header">
    <h1><%= item && item._id ? 'Edit' : 'Add' %> Gallery Item</h1>
    <div class="admin-actions">
      <a class="btn-secondary" href="/admin">Dashboard</a>
      <a href="/admin/gallery" class="btn-admin">Back to list</a>
    </div>
  </div>

  <div class="admin-card">
    <% if (errors && errors.length) { %>
      <ul>
        <% errors.forEach(function(e){ %>
          <li style="color:red"><%= e %></li>
        <% }) %>
      </ul>
    <% } %>

    <form class="admin-form" method="post" action="<%= item && item._id ? ('/admin/gallery/' + item._id) : '/admin/gallery' %>" enctype="multipart/form-data">
      <label>Title
        <input name="title" value="<%= item && item.title ? item.title : '' %>" required>
      </label>

      <label>Category
        <select name="category">
          <% const categories = ['Uncategorized','Residential','Commercial','Renovation']; %>
          <% categories.forEach(function(c){ %>
            <option value="<%= c %>" <%= (item && item.category === c) ? 'selected' : '' %>><%= c %></option>
          <% }) %>
        </select>
      </label>

      <label>Caption
        <textarea name="caption"><%= item && item.caption ? item.caption : '' %></textarea>
      </label>

      <label>Image file (choose to upload) <small class="muted">Max 5MB per image, up to 6 images</small>
        <input id="imageFiles" type="file" name="images" accept="image/*" multiple>
      </label>

      <label>Image URLs (one per line)
        <textarea id="imageUrl" name="imageUrls" rows="3" placeholder="Paste image URLs here, one per line"><%= item && item.images ? (item.images.join('\n')) : '' %></textarea>
      </label>

      <div id="previewWrap" class="multi-preview">
        <% if (item && item.images && item.images.length) { %>
          <% item.images.slice(0,6).forEach(function(i){ %>
            <img src="<%= i %>" class="admin-image-preview" alt="preview">
          <% }) %>
        <% } else { %>
          <div class="muted">No images selected</div>
        <% } %>
      </div>

      <div style="margin-top:12px">
        <button class="btn-admin" type="submit">Save</button>
      </div>
    </form>
  </div>
</main>



<%- include('../partials/footer') %>